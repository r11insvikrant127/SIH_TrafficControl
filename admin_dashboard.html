<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Odisha Traffic Management System - Admin Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #1a237e;
            --secondary-color: #283593;
            --accent-color: #3949ab;
            --alert-color: #d32f2f;
            --success-color: #388e3c;
            --warning-color: #f57c00;
            --text-color: #f5f5f5;
            --bg-color: #000000; /* Changed to black */
            --card-bg: #111111; /* Dark gray */
            --border-color: #333333; /* Dark gray */
            --header-bg: #111111; /* Dark gray */
            --search-bg: rgba(255, 255, 255, 0.1);
            --sidebar-bg: #111111; /* Dark gray */
            --sidebar-width: 250px;
            --sidebar-collapsed: 70px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            font-family: 'Roboto', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0; 
            padding: 0;
            background: #000000; /* Changed to solid black */
            color: var(--text-color); 
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            background: #111111; /* Dark gray */
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            padding-top: 20px;
            transition: all 0.3s ease;
            z-index: 100;
            overflow-y: auto;
        }
        
        .sidebar.collapsed {
            width: var(--sidebar-collapsed);
        }
        
        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .sidebar-header h3 {
            margin-left: 10px;
            white-space: nowrap;
            overflow: hidden;
        }
        
        .sidebar.collapsed .sidebar-header h3 {
            display: none;
        }
        
        .sidebar-menu {
            list-style: none;
        }
        
        .menu-item {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }
        
        .menu-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .menu-item.active {
            background: var(--accent-color);
            border-left: 4px solid #64b5f6;
        }
        
        .menu-item i {
            margin-right: 15px;
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }
        
        .menu-text {
            white-space: nowrap;
            overflow: hidden;
        }
        
        .sidebar.collapsed .menu-text {
            display: none;
        }
        
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .main-content.expanded {
            margin-left: var(--sidebar-collapsed);
        }
        
        .toggle-sidebar {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 101;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px 20px;
            background: #111111; /* Dark gray */
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.6); /* Darker shadow */
            position: relative;
        }
        
        .header-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .header-logo img {
            height: 50px;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-auto-rows: minmax(200px, auto);
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .card {
            background: #111111; /* Dark gray instead of pure black for better contrast */
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.6); /* Darker shadow */
            border: 1px solid #333333; /* Darker border */
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.4);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .stat-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
            background: linear-gradient(45deg, #64b5f6, #1976d2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #e3f2fd;
        }
        
        .cameras-container {
            grid-column: span 4;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .camera-card {
            background: #111111; /* Dark gray */
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.6); /* Darker shadow */
            border: 1px solid #333333; /* Darker border */
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .camera-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.4);
        }
        
        .video-container {
            position: relative;
            width: 100%;
            height: 180px;
            background: #000;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .video-feed {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .video-status {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-live {
            background: var(--alert-color);
            color: white;
        }
        
        .status-high {
            background: var(--alert-color);
        }
        
        .status-medium {
            background: var(--warning-color);
        }
        
        .status-critical {
            background: var(--alert-color);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .video-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        
        .signal-network {
            grid-column: span 2;
        }
        
        .signal-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
            transition: background 0.2s;
        }
        
        .signal-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .signal-item:last-child {
            border-bottom: none;
        }
        
        .signal-name {
            font-weight: bold;
        }
        
        .signal-location {
            font-size: 0.9rem;
            color: #bbdefb;
        }
        
        .signal-mode {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .mode-automatic {
            background: var(--accent-color);
        }
        
        .mode-manual {
            background: var(--warning-color);
        }
        
        .mode-emergency {
            background: var(--alert-color);
        }
        
        .control-panel {
            grid-column: span 2;
        }
        
        .signal-mode-selector {
            display: flex;
            margin-bottom: 15px;
        }
        
        .mode-option {
            padding: 8px 15px;
            background: var(--secondary-color);
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .mode-option:first-child {
            border-radius: 4px 0 0 4px;
        }
        
        .mode-option:last-child {
            border-radius: 0 4px 4px 0;
        }
        
        .mode-option.active {
            background: var(--accent-color);
        }
        
        .timing-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        .timing-table th, .timing-table td {
            padding: 10px;
            text-align: center;
            border: 1px solid var(--border-color);
        }
        
        .timing-table th {
            background: #222222; /* Dark gray */
        }
        
        .timing-table input {
            width: 60px;
            padding: 5px;
            background: var(--secondary-color);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            text-align: center;
        }
        
        .apply-button {
            padding: 10px 20px;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .apply-button:hover {
            background: #1565c0;
        }
        
        .apply-button:disabled {
            background: #5c6bc0;
            cursor: not-allowed;
        }
        
        .alert-log {
            grid-column: span 2;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .alert-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .alert-table th, .alert-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        
        .alert-table th {
             background: #222222; /* Dark gray */
            position: sticky;
            top: 0;
        }
        
        .priority-critical {
            color: var(--alert-color);
            font-weight: bold;
        }
        
        .priority-high {
            color: var(--warning-color);
        }
        
        .status-active {
            color: var(--alert-color);
        }
        
        .status-resolved {
            color: var(--success-color);
        }
        
        .alert-details {
            grid-column: span 2;
        }
        
        .detail-item {
            margin-bottom: 15px;
        }
        
        .detail-label {
            font-size: 0.9rem;
            color: #bbdefb;
            margin-bottom: 5px;
        }
        
        .detail-value {
            font-size: 1.1rem;
        }
        
        .resolve-button {
            padding: 10px 20px;
            background: var(--success-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 15px;
            transition: background-color 0.3s;
        }
        
        .resolve-button:hover {
            background: #2e7d32;
        }
        
        .resolve-button:disabled {
            background: #81c784;
            cursor: not-allowed;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .traffic-chart {
            grid-column: span 2;
        }
        
        .breakdown-chart {
            grid-column: span 2;
        }
        
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 4px;
            color: white;
            z-index: 1000;
            opacity: 0;
            transform: translateX(100px);
            transition: all 0.3s ease;
        }
        
        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .notification.success {
            background: var(--success-color);
        }
        
        .notification.error {
            background: var(--alert-color);
        }
        
        .notification.warning {
            background: var(--warning-color);
        }
        
        .govt-badge {
            background: linear-gradient(45deg, #ff6f00, #ffa000);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .refresh-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s;
        }
        
        .refresh-btn:hover {
            background: #1565c0;
        }
        
        /* Search Places Dropdown */
        .search-places-container {
            position: relative;
            display: inline-block;
        }
        
        .search-places-dropdown {
            background: var(--search-bg);
            border-radius: 20px;
            padding: 8px 15px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            display: flex;
            align-items: center;
            min-width: 200px;
        }
        
        .search-places-dropdown i {
            margin-right: 8px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .search-places-dropdown span {
            color: rgba(255, 255, 255, 0.9);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
        }
        
        .places-dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--card-bg);
            border-radius: 8px;
            padding: 10px 0;
            min-width: 200px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: none;
            z-index: 1000;
            margin-top: 5px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .places-dropdown-menu.show {
            display: block;
        }
        
        .places-dropdown-item {
            padding: 10px 20px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .places-dropdown-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* View Controls */
        .view-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .view-btn {
            padding: 10px 20px;
            background: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .view-btn.active {
            background: var(--accent-color);
        }
        
        /* Section visibility */
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .cameras-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .signal-network, .control-panel, .alert-log, .alert-details {
                grid-column: span 2;
            }
            
            .sidebar {
                width: var(--sidebar-collapsed);
            }
            
            .sidebar .menu-text {
                display: none;
            }
            
            .main-content {
                margin-left: var(--sidebar-collapsed);
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .cameras-container {
                grid-template-columns: 1fr;
            }
            
            .signal-network, .control-panel, .alert-log, .alert-details {
                grid-column: span 1;
            }
            
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .search-places-container {
                margin-top: 15px;
                width: 100%;
            }
            
            .sidebar {
                width: 0;
                overflow: hidden;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .sidebar.show-mobile {
                width: var(--sidebar-width);
            }
            
            .sidebar.show-mobile .menu-text {
                display: block;
            }
            
            .toggle-sidebar {
                display: flex;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar Navigation -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <i class="fas fa-traffic-light"></i>
            <h3>Odisha Traffic</h3>
        </div>
        <ul class="sidebar-menu">
            <li class="menu-item active" data-section="dashboard">
                <i class="fas fa-th-large"></i>
                <span class="menu-text">Dashboard</span>
            </li>
            <li class="menu-item" data-section="cameras">
                <i class="fas fa-video"></i>
                <span class="menu-text">Cameras</span>
            </li>
            <li class="menu-item" data-section="signals">
                <i class="fas fa-traffic-light"></i>
                <span class="menu-text">Signals</span>
            </li>
            <li class="menu-item" data-section="maps">
                <i class="fas fa-map-marked-alt"></i>
                <span class="menu-text">Maps</span>
            </li>
            <li class="menu-item" data-section="analytics">
                <i class="fas fa-chart-line"></i>
                <span class="menu-text">Analytics</span>
            </li>
            <li class="menu-item" data-section="settings">
                <i class="fas fa-cog"></i>
                <span class="menu-text">Settings</span>
            </li>
        </ul>
    </div>
    
    <button class="toggle-sidebar" id="toggle-sidebar">
        <i class="fas fa-bars"></i>
    </button>

    <div class="main-content" id="main-content">
        <div class="dashboard-header">
            <div class="header-logo">
                <div>
                    <h1>Odisha Traffic Management System</h1>
                    <p>Government of Odisha Initiative</p>
                </div>
            </div>
            <div class="govt-badge">ADMIN DASHBOARD</div>
            
            <!-- Search Places Dropdown -->
            <div class="search-places-container">
                <div class="search-places-dropdown" id="places-dropdown">
                    <i class="fas fa-search"></i>
                    <span>Select places...</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="places-dropdown-menu" id="places-menu">
                    <div class="places-dropdown-item" data-place="all">All Locations</div>
                    <div class="places-dropdown-item" data-place="bhubaneswar">Bhubaneswar</div>
                    <div class="places-dropdown-item" data-place="cuttack">Cuttack</div>
                    <div class="places-dropdown-item" data-place="puri">Puri</div>
                    <div class="places-dropdown-item" data-place="rourkela">Rourkela</div>
                    <div class="places-dropdown-item" data-place="sambalpur">Sambalpur</div>
                    <div class="places-dropdown-item" data-place="brahmapur">Brahmapur</div>
                </div>
            </div>
        </div>

        <div id="notification" class="notification"></div>

        <!-- View Controls -->
        <div class="view-controls">
            <button class="view-btn active" data-view="overview">Overview</button>
            <button class="view-btn" data-view="detailed">Detailed View</button>
            <button class="view-btn" data-view="analytics">Analytics</button>
        </div>

        <!-- Dashboard Section -->
        <div class="section active" id="dashboard-section">
            <!-- Camera Feeds Section -->
            <div class="cameras-container">
                <div class="camera-card">
                    <h3>Bhubaneswar - Master Canteen Square</h3>
                    <div class="video-container">
                        <img id="video-feed-0" class="video-feed" src="/video_feed/0" alt="Bhubaneswar - Master Canteen Square">
                        <div class="video-status status-live">LIVE</div>
                    </div>
                    <div class="video-info">
                        <div>Odisha, India</div>
                        <div>Vehicles: <span id="cam-0-count">0</span> | Speed: <span id="cam-0-speed">0</span> km/h</div>
                    </div>
                </div>
                
                <div class="camera-card">
                    <h3>Cuttack - Badambadi Bus Stand</h3>
                    <div class="video-container">
                        <img id="video-feed-1" class="video-feed" src="/video_feed/1" alt="Cuttack - Badambadi Bus Stand">
                        <div class="video-status status-live">LIVE</div>
                    </div>
                    <div class="video-info">
                        <div>Odisha, India</div>
                        <div>Vehicles: <span id="cam-1-count">0</span> | Speed: <span id="cam-1-speed">0</span> km/h</div>
                    </div>
                </div>
                
                <div class="camera-card">
                    <h3>Puri - Grand Road Junction</h3>
                    <div class="video-container">
                        <img id="video-feed-2" class="video-feed" src="/video_feed/2" alt="Puri - Grand Road Junction">
                        <div class="video-status status-live">LIVE</div>
                    </div>
                    <div class="video-info">
                        <div>Odisha, India</div>
                        <div>Vehicles: <span id="cam-2-count">0</span> | Speed: <span id="cam-2-speed">0</span> km/h</div>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid">
                <!-- Stats Cards -->
                <div class="card stat-card">
                    <h3>Commute Time Reduction</h3>
                    <div class="stat-value" id="commute-reduction">0%</div>
                    <div class="stat-label">Compared to baseline</div>
                </div>
                
                <div class="card stat-card">
                    <h3>Total Alerts</h3>
                    <div class="stat-value" id="total-alerts">0</div>
                    <div class="stat-label">Active alerts</div>
                </div>
                
                <div class="card stat-card">
                    <h3>Vehicles Detected</h3>
                    <div class="stat-value" id="total-vehicles">0</div>
                    <div class="stat-label">Across all cameras</div>
                </div>
                
                <div class="card stat-card">
                    <h3>System Uptime</h3>
                    <div class="stat-value" id="system-uptime-value">99.8%</div>
                    <div class="stat-label">Current status: <span style="color: #4caf50;">Online</span></div>
                </div>

                <!-- Signal Network -->
                <div class="card signal-network">
                    <div class="card-header">
                        <h2>Signal Network</h2>
                        <button class="refresh-btn" onclick="refreshSignalData()">Refresh</button>
                    </div>
                    <div id="signal-network-content">
                        <div class="signal-item">
                            <div>
                                <div class="signal-name">Loading signals...</div>
                                <div class="signal-location">Please wait</div>
                            </div>
                            <div class="signal-mode mode-automatic">loading</div>
                        </div>
                    </div>
                </div>

                <!-- Control Panel -->
                <div class="card control-panel">
                    <div class="card-header">
                        <h2>Control Panel: <span id="control-intersection">Bhubaneswar - Master Canteen Square</span></h2>
                        <select id="intersection-selector" onchange="changeIntersection(this.value)">
                            <option value="0">Bhubaneswar - Master Canteen Square</option>
                            <option value="1">Cuttack - Badambadi Bus Stand</option>
                            <option value="2">Puri - Grand Road Junction</option>
                            <option value="3">Bhubaneswar - Vani Vihar</option>
                            <option value="4">Rourkela - Sector 19</option>
                            <option value="5">Sambalpur - Ainthapali</option>
                            <option value="6">Brahmapur - Aska Road</option>
                        </select>
                    </div>
                    <h3>Signal Mode</h3>
                    <div class="signal-mode-selector">
                        <div class="mode-option active" data-mode="automatic" onclick="setSignalMode('automatic')">Automatic</div>
                        <div class="mode-option" data-mode="manual" onclick="setSignalMode('manual')">Manual</div>
                        <div class="mode-option" data-mode="emergency" onclick="setSignalMode('emergency')">Emergency</div>
                    </div>
                    
                    <div id="manual-controls" style="display: none;">
                        <h3>Timing Plan (seconds)</h3>
                        <table class="timing-table">
                            <tr>
                                <th>North</th>
                                <th>East</th>
                                <th>South</th>
                                <th>West</th>
                            </tr>
                            <tr>
                                <td><input type="number" id="timing-north" value="30" min="10" max="120"></td>
                                <td><input type="number" id="timing-east" value="30" min="10" max="120"></td>
                                <td><input type="number" id="timing-south" value="30" min="10" max="120"></td>
                                <td><input type="number" id="timing-west" value="30" min="10" max="120"></td>
                            </tr>
                        </table>
                    </div>
                    
                    <div id="auto-timings">
                        <h3>Current Automatic Timings</h3>
                        <p>Timings adjust automatically based on traffic congestion levels</p>
                        <div id="current-timings-display">
                            <p>North: <span id="auto-north">30</span>s | East: <span id="auto-east">30</span>s</p>
                            <p>South: <span id="auto-south">30</span>s | West: <span id="auto-west">30</span>s</p>
                        </div>
                    </div>
                    
                    <button class="apply-button" id="apply-button" onclick="applySignalChanges()">Apply Changes</button>
                </div>

                <!-- Alert Log -->
                <div class="card alert-log">
                    <div class="card-header">
                        <h2>Alert Log</h2>
                        <span>Manage and respond to system-wide incidents.</span>
                    </div>
                    <table class="alert-table">
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Location</th>
                                <th>Priority</th>
                                <th>Status</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="alert-table-body">
                            <tr>
                                <td colspan="5" style="text-align: center;">Loading alerts...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Alert Details -->
                <div class="card alert-details">
                    <div class="card-header">
                        <h2 id="alert-detail-title">Alert Details</h2>
                    </div>
                    <div id="alert-detail-content">
                        <div class="detail-item">
                            <div class="detail-label">Select an alert to view details</div>
                            <div class="detail-value">No alert selected</div>
                        </div>
                    </div>
                    <button class="resolve-button" id="resolve-button" onclick="resolveAlert()" disabled>Mark as Resolved</button>
                </div>

                <!-- Traffic Charts -->
                <div class="card traffic-chart">
                    <div class="card-header">
                        <h2>Hourly Traffic Volume</h2>
                        <button class="refresh-btn" onclick="refreshCharts()">Refresh</button>
                    </div>
                    <div class="chart-container">
                        <canvas id="trafficVolumeChart"></canvas>
                    </div>
                </div>
                
                <div class="card breakdown-chart">
                    <div class="card-header">
                        <h2>Alert Type Breakdown</h2>
                    </div>
                    <div class="chart-container">
                        <canvas id="alertBreakdownChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Other Sections (initially hidden) -->
        <div class="section" id="cameras-section">
            <div class="card">
                <div class="card-header">
                    <h2>Camera Management</h2>
                </div>
                <div class="cameras-container">
                    <!-- Camera feeds will be loaded here -->
                </div>
                <div class="camera-controls">
                    <h3>Camera Controls</h3>
                    <p>Adjust camera settings, PTZ controls, and recording options here.</p>
                    <!-- Additional camera controls will be implemented here -->
                </div>
            </div>
        </div>

        <div class="section" id="signals-section">
            <div class="card">
                <div class="card-header">
                    <h2>Signal Management</h2>
                </div>
                <div class="signal-management">
                    <h3>Traffic Signal Controls</h3>
                    <p>Manage all traffic signals across Odisha from this centralized interface.</p>
                    <!-- Signal management controls will be implemented here -->
                </div>
            </div>
        </div>

        <div class="section" id="maps-section">
            <div class="card">
                <div class="card-header">
                    <h2>Traffic Maps</h2>
                </div>
                <div class="traffic-maps">
                    <h3>Live Traffic Conditions</h3>
                    <p>View real-time traffic flow and congestion patterns across Odisha.</p>
                    <!-- Map visualization will be implemented here -->
                </div>
            </div>
        </div>

        <div class="section" id="analytics-section">
            <div class="card">
                <div class="card-header">
                    <h2>Traffic Analytics</h2>
                </div>
                <div class="analytics-content">
                    <h3>Historical Data & Trends</h3>
                    <p>Analyze traffic patterns, peak hours, and historical trends.</p>
                    <!-- Advanced analytics visualizations will be implemented here -->
                </div>
            </div>
        </div>

        <div class="section" id="settings-section">
            <div class="card">
                <div class="card-header">
                    <h2>System Settings</h2>
                </div>
                <div class="settings-content">
                    <h3>Configuration & Preferences</h3>
                    <p>Adjust system settings, user permissions, and notification preferences.</p>
                    <!-- Settings controls will be implemented here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentIntersection = 0;
        let currentSignalMode = 'automatic';
        let currentAlert = null;
        let trafficVolumeChart = null;
        let alertBreakdownChart = null;
        let alertData = [];
        let commuteReduction = 0;
        let currentTrafficData = {
            hours: [],
            counts: []
        };
        let currentLocation = 'all';

        // Initialize charts
        function initCharts() {
            const trafficCtx = document.getElementById('trafficVolumeChart').getContext('2d');
            trafficVolumeChart = new Chart(trafficCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Vehicle Count',
                        data: [],
                        borderColor: '#64b5f6',
                        backgroundColor: 'rgba(100, 181, 246, 0.2)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 400,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#fff'
                            }
                        }
                    }
                }
            });
            
            const alertCtx = document.getElementById('alertBreakdownChart').getContext('2d');
            alertBreakdownChart = new Chart(alertCtx, {
                type: 'doughnut',
                data: {
                    labels: [],
                    datasets: [{
                        data: [],
                        backgroundColor: [
                            '#e74c3c',
                            '#3498db',
                            '#f39c12',
                            '#9b59b6'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: '#fff'
                            }
                        }
                    }
                }
            });
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Update signal network display with Odisha-specific names
        function updateSignalNetwork(signals) {
            const container = document.getElementById('signal-network-content');
            if (!signals || signals.length === 0) {
                container.innerHTML = '<div class="signal-item"><div>No signal data available</div></div>';
                return;
            }
            
            // Odisha-specific intersection names
            const odishaIntersections = [
                "Bhubaneswar - Master Canteen Square",
                "Cuttack - Badambadi Bus Stand", 
                "Puri - Grand Road Junction",
                "Bhubaneswar - Vani Vihar",
                "Rourkela - Sector 19",
                "Sambalpur - Ainthapali",
                "Brahmapur - Aska Road"
            ];
            
            let html = '';
            signals.forEach((signal, index) => {
                // Use Odisha-specific names if available, otherwise fall back to original
                const signalName = odishaIntersections[index] || signal.name;
                const location = signal.location.includes("Odisha") ? signal.location : `${signal.location}, Odisha, India`;
                
                html += `
                    <div class="signal-item">
                        <div>
                            <div class="signal-name">${signalName}</div>
                            <div class="signal-location">${location}</div>
                        </div>
                        <div class="signal-mode mode-${signal.mode}">${signal.mode}</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function updateAlertLog(alerts) {
            const container = document.getElementById('alert-table-body');
            const totalAlerts = document.getElementById('total-alerts');
    
            // Store alerts globally
            alertData = alerts || [];

            // Filter to show only active alerts
            const activeAlerts = alertData.filter(alert => alert.status === 'active');

            if (activeAlerts.length === 0) {
                container.innerHTML = '<tr><td colspan="5" style="text-align: center;">No active alerts</td></tr>';
                totalAlerts.textContent = '0';
                return;
            }

            let html = '';
            activeAlerts.forEach((alert, index) => {
            html += `
                <tr onclick="selectAlert(${alertData.indexOf(alert)})">
                    <td>${alert.type}</td>
                    <td>${alert.location}</td>
                    <td class="priority-${alert.priority}">${alert.priority}</td>
                    <td class="status-${alert.status}">${alert.status}</td>
                    <td>${alert.time}</td>
                </tr>
            `;
        });
    
    container.innerHTML = html;
    totalAlerts.textContent = activeAlerts.length;
}

        // Select alert for details view
        function selectAlert(index) {
            if (!alertData || index >= alertData.length) return;
            
            const alert = alertData[index];
            currentAlert = { index, ...alert };
            
            const detailTitle = document.getElementById('alert-detail-title');
            const detailContent = document.getElementById('alert-detail-content');
            const resolveButton = document.getElementById('resolve-button');
            
            detailTitle.textContent = `${alert.type} Details`;
            
            detailContent.innerHTML = `
                <div class="detail-item">
                    <div class="detail-label">Location</div>
                    <div class="detail-value">${alert.location}, Odisha, India</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Type</div>
                    <div class="detail-value">${alert.type}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Priority</div>
                    <div class="detail-value priority-${alert.priority}">${alert.priority}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Status</div>
                    <div class="detail-value status-${alert.status}">${alert.status}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Reported At</div>
                    <div class="detail-value">${new Date().toLocaleDateString()}, ${alert.time}</div>
                </div>
            `;
            
            resolveButton.disabled = alert.status !== 'active';
        }

        function resolveAlert() {
            if (!currentAlert) return;
    
            // Update the alert status to resolved
            alertData[currentAlert.index].status = 'resolved';

            // Update the UI
            updateAlertLog(alertData);

            // Show notification
            showNotification(`Alert at ${currentAlert.location} resolved successfully`);

            // Clear details view
            document.getElementById('alert-detail-title').textContent = 'Alert Details';
            document.getElementById('alert-detail-content').innerHTML = `
                <div class="detail-item">
                    <div class="detail-label">Select an alert to view details</div>
                    <div class="detail-value">No alert selected</div>
                </div>
            `;
            document.getElementById('resolve-button').disabled = true;

            currentAlert = null;
        }

        // Change intersection in control panel
        function changeIntersection(intersectionId) {
            currentIntersection = parseInt(intersectionId);
            const intersectionNames = [
                'Bhubaneswar - Master Canteen Square',
                'Cuttack - Badambadi Bus Stand',
                'Puri - Grand Road Junction',
                'Bhubaneswar - Vani Vihar',
                'Rourkela - Sector 19',
                'Sambalpur - Ainthapali',
                'Brahmapur - Aska Road'
            ];
            
            document.getElementById('control-intersection').textContent = intersectionNames[currentIntersection];
            
            // Reset to automatic mode when changing intersection
            setSignalMode('automatic');
        }

        // Set signal mode in control panel
        function setSignalMode(mode) {
            currentSignalMode = mode;
            
            // Update UI
            document.querySelectorAll('.mode-option').forEach(option => {
                option.classList.remove('active');
            });
            document.querySelector(`.mode-option[data-mode="${mode}"]`).classList.add('active');
            
            // Show/hide manual controls
            document.getElementById('manual-controls').style.display = mode === 'manual' ? 'block' : 'none';
            document.getElementById('auto-timings').style.display = mode === 'automatic' ? 'block' : 'none';
            
            // Update signal network to reflect changes
            updateSignalStatusInNetwork(currentIntersection, mode);
        }

        // Update signal status in the network display
        function updateSignalStatusInNetwork(intersectionId, mode) {
            const signalItems = document.querySelectorAll('.signal-item');
            if (signalItems.length > intersectionId) {
                const modeElement = signalItems[intersectionId].querySelector('.signal-mode');
                modeElement.className = `signal-mode mode-${mode}`;
                modeElement.textContent = mode;
            }
        }

        // Apply signal changes
        function applySignalChanges() {
            const button = document.getElementById('apply-button');
            button.disabled = true;
            button.textContent = 'Applying...';
            
            let timings = null;
            if (currentSignalMode === 'manual') {
                timings = [
                    parseInt(document.getElementById('timing-north').value),
                    parseInt(document.getElementById('timing-east').value),
                    parseInt(document.getElementById('timing-south').value),
                    parseInt(document.getElementById('timing-west').value)
                ];
            }
            
            // Simulate API call
            setTimeout(() => {
                showNotification('Signal changes applied successfully');
                
                // Update signal network to reflect changes
                updateSignalStatusInNetwork(currentIntersection, currentSignalMode);
                
                button.disabled = false;
                button.textContent = 'Apply Changes';
            }, 1000);
        }

        // Update charts with data
        function updateCharts(trafficData, alertData) {
            if (trafficVolumeChart && trafficData) {
                trafficVolumeChart.data.labels = trafficData.hours;
                trafficVolumeChart.data.datasets[0].data = trafficData.counts;
                trafficVolumeChart.update();
            }
            
            if (alertBreakdownChart && alertData) {
                alertBreakdownChart.data.labels = alertData.types;
                alertBreakdownChart.data.datasets[0].data = alertData.counts;
                alertBreakdownChart.update();
            }
        }

        // Calculate commute time reduction
        function calculateCommuteReduction() {
            // Simulate calculation based on traffic data
            const reduction = Math.floor(Math.random() * 15) + 10; // Random between 10-25%
            commuteReduction = reduction;
            document.getElementById('commute-reduction').textContent = `${reduction}%`;
        }

        function generateDynamicTrafficData() {
            // Get vehicle counts from camera feeds
            const cam0Count = parseInt(document.getElementById('cam-0-count').textContent) || 0;
            const cam1Count = parseInt(document.getElementById('cam-1-count').textContent) || 0;
            const cam2Count = parseInt(document.getElementById('cam-2-count').textContent) || 0;

            // Calculate total vehicles
                const totalVehicles = cam0Count + cam1Count + cam2Count;
            document.getElementById('total-vehicles').textContent = totalVehicles;
    
            // Update traffic volume chart with live data
            const now = new Date();
            const currentTime = now.toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});
    
            // Keep only the last 12 data points
            if (currentTrafficData.hours.length >= 12) {
                currentTrafficData.hours.shift();
                currentTrafficData.counts.shift();
            }
    
            // Add current data with actual time
            currentTrafficData.hours.push(currentTime);
            currentTrafficData.counts.push(totalVehicles);
    
            // Update chart
            if (trafficVolumeChart) {
                trafficVolumeChart.data.labels = currentTrafficData.hours;
                trafficVolumeChart.data.datasets[0].data = currentTrafficData.counts;
                trafficVolumeChart.update();
            }

            // Update alert breakdown based on traffic conditions
            updateAlertBreakdown(totalVehicles);

            // Calculate commute reduction
            calculateCommuteReduction();
        }

        // Update alert breakdown based on traffic conditions
        function updateAlertBreakdown(totalVehicles) {
            // Simulate alert data based on traffic conditions
            const alertTypes = ['Congestion', 'Accident', 'Roadwork', 'Weather'];
            const alertCounts = [0, 0, 0, 0];
            
            // More congestion alerts during high traffic
            if (totalVehicles > 50) {
                alertCounts[0] = Math.floor(totalVehicles / 10);
            }
            
            // Random other alerts
            alertCounts[1] = Math.floor(Math.random() * 3);
            alertCounts[2] = Math.floor(Math.random() * 2);
            alertCounts[3] = Math.floor(Math.random() * 2);
            
            // Update chart
            if (alertBreakdownChart) {
                alertBreakdownChart.data.labels = alertTypes;
                alertBreakdownChart.data.datasets[0].data = alertCounts;
                alertBreakdownChart.update();
            }
        }

        // Simulate camera data updates
        function simulateCameraData() {
            // Random vehicle counts
            const cam0Count = Math.floor(Math.random() * 30) + 10;
            const cam1Count = Math.floor(Math.random() * 40) + 15;
            const cam2Count = Math.floor(Math.random() * 35) + 5;
            
            // Random speeds
            const cam0Speed = Math.floor(Math.random() * 40) + 20;
            const cam1Speed = Math.floor(Math.random() * 35) + 15;
            const cam2Speed = Math.floor(Math.random() * 45) + 25;
            
            // Update UI
            document.getElementById('cam-0-count').textContent = cam0Count;
            document.getElementById('cam-0-speed').textContent = cam0Speed;
            
            document.getElementById('cam-1-count').textContent = cam1Count;
            document.getElementById('cam-1-speed').textContent = cam1Speed;
            
            document.getElementById('cam-2-count').textContent = cam2Count;
            document.getElementById('cam-2-speed').textContent = cam2Speed;
            
            // Update dynamic traffic data
            generateDynamicTrafficData();
        }

        // Load signal data from server
        function loadSignalData() {

            // Function to generate dynamic alerts
            function generateDynamicAlerts() {
                const alertTypes = ['Congestion', 'Accident', 'Roadwork', 'Weather', 'Emergency Vehicle'];
                const locations = [
                    'Bhubaneswar - Master Canteen Square',
                    'Cuttack - Badambadi Bus Stand', 
                    'Puri - Grand Road Junction',
                    'Bhubaneswar - Vani Vihar',
                    'Rourkela - Sector 19'
                ];
                const priorities = ['low', 'medium', 'high', 'critical'];

                // Generate random number of alerts (1-5)
                const numAlerts = Math.floor(Math.random() * 5) + 1;
                const alerts = [];

                for (let i = 0; i < numAlerts; i++) {
                    alerts.push({
                        type: alertTypes[Math.floor(Math.random() * alertTypes.length)],
                        location: locations[Math.floor(Math.random() * locations.length)],
                        priority: priorities[Math.floor(Math.random() * priorities.length)],
                        status: 'active',
                        time: new Date().toLocaleTimeString()
                    });
                }

                return alerts;
            }           

            // Simulate API response
            const simulatedResponse = {
                signals: [
                    { name: "Bhubaneswar - Master Canteen Square", location: "Bhubaneswar, Odisha", mode: "automatic" },
                    { name: "Cuttack - Badambadi Bus Stand", location: "Cuttack, Odisha", mode: "automatic" },
                    { name: "Puri - Grand Road Junction", location: "Puri, Odisha", mode: "automatic" },
                    { name: "Bhubaneswar - Vani Vihar", location: "Bhubaneswar, Odisha", mode: "automatic" },
                    { name: "Rourkela - Sector 19", location: "Rourkela, Odisha", mode: "automatic" },
                    { name: "Sambalpur - Ainthapali", location: "Sambalpur, Odisha", mode: "automatic" },
                    { name: "Brahmapur - Aska Road", location: "Brahmapur, Odisha", mode: "automatic" }
                ],
                alerts: generateDynamicAlerts()  // Replace the static alerts with this
            };
            
            updateSignalNetwork(simulatedResponse.signals);
            updateAlertLog(simulatedResponse.alerts);
            
            // Calculate commute time reduction
            calculateCommuteReduction();
        }

        // Refresh signal data
        function refreshSignalData() {
            const button = document.querySelector('.signal-network .refresh-btn');
            button.innerHTML = '<i class="fas fa-sync fa-spin"></i> Refreshing';
            
            loadSignalData();
            
            setTimeout(() => {
                button.innerHTML = 'Refresh';
                showNotification('Signal data refreshed');
            }, 1000);
        }

        // Refresh charts
        function refreshCharts() {
            const button = document.querySelector('.traffic-chart .refresh-btn');
            button.innerHTML = '<i class="fas fa-sync fa-spin"></i> Refreshing';
            
            // Simulate API call
            setTimeout(() => {
                simulateCameraData();
                button.innerHTML = 'Refresh';
                showNotification('Charts refreshed with latest data');
            }, 1000);
        }

        // Toggle sidebar
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            
            sidebar.classList.toggle('collapsed');
            mainContent.classList.toggle('expanded');
            
            // Change icon based on state
            const icon = document.querySelector('#toggle-sidebar i');
            if (sidebar.classList.contains('collapsed')) {
                icon.className = 'fas fa-bars';
            } else {
                icon.className = 'fas fa-times';
            }
        }

        // Switch between sections
        function switchSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId + '-section').classList.add('active');
            
            // Update menu active state
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.querySelector(`.menu-item[data-section="${sectionId}"]`).classList.add('active');
            
            // If switching to dashboard, refresh data
            if (sectionId === 'dashboard') {
                loadSignalData();
            }
        }

        // Switch between views
        function switchView(viewType) {
            // This would control different view layouts in a real application
            console.log('Switching to view:', viewType);
            // Implementation would vary based on specific view requirements
        }

        // Initialize dashboard
        function initDashboard() {
            initCharts();
            loadSignalData();
            
            // Set up periodic updates
            setInterval(simulateCameraData, 5000); // Update camera data every 5 seconds
            setInterval(loadSignalData, 15000); // Refresh alerts every 15 seconds
            setInterval(generateDynamicTrafficData, 10000); // Update traffic data every 10 seconds
            
            // Set up search functionality
            document.getElementById('places-dropdown').addEventListener('click', function() {
                document.getElementById('places-menu').classList.toggle('show');
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.search-places-container')) {
                    document.getElementById('places-menu').classList.remove('show');
                }
            });
            
            // Handle place selection
            document.querySelectorAll('.places-dropdown-item').forEach(item => {
                item.addEventListener('click', function() {
                    currentLocation = this.getAttribute('data-place');
                    document.querySelector('#places-dropdown span').textContent = 
                        currentLocation === 'all' ? 'All Locations' : this.textContent;
                    document.getElementById('places-menu').classList.remove('show');
                    
                    // Filter data based on selection
                    loadSignalData();
                });
            });
            
            // Set up sidebar menu
            document.querySelectorAll('.menu-item').forEach(item => {
                item.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    switchSection(section);
                });
            });
            
            // Set up view controls
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    switchView(this.getAttribute('data-view'));
                });
            });
            
            // Set up sidebar toggle
            document.getElementById('toggle-sidebar').addEventListener('click', toggleSidebar);
        }

        // Initialize when page loads
        window.onload = initDashboard;
    </script>
</body>
</html>
